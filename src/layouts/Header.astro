---
import ThemeToggleButton from '../components/ThemeToggleButton.astro'

const sections = ['About', 'Experience', 'Projects']
---

<header
  class='sticky top-0 z-50 flex items-center justify-between border-b bg-white p-4 dark:bg-cod-gray-950 dark:text-white'
>
  <h2><a href='#about'> Alonso Garay</a></h2>
  <ThemeToggleButton />
  <nav class='ml-1 flex items-center gap-4'>
    {
      sections.map((sec) => (
        <a
          href={`#${sec.toLowerCase()}`}
          class='hover:scale-110 hover:text-cod-gray-700 dark:hover:text-gray-400'
        >
          {sec}
        </a>
      ))
    }
  </nav>
</header>

<script>
  var themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon')
  var themeToggleLightIcon = document.getElementById('theme-toggle-light-icon')

  if (
    localStorage.getItem('color-theme') === 'dark' ||
    (!('color-theme' in localStorage) &&
      window.matchMedia('(prefers-color-scheme: dark)').matches)
  ) {
    if (themeToggleLightIcon) {
      themeToggleLightIcon.classList.remove('hidden')
    }
  } else {
    if (themeToggleDarkIcon) {
      themeToggleDarkIcon.classList.remove('hidden')
    }
  }

  var themeToggleBtn = document.getElementById('theme-toggle')

  if (themeToggleBtn) {
    themeToggleBtn.addEventListener('click', function () {
      // toggle icons inside button
      if (themeToggleDarkIcon) {
        themeToggleDarkIcon.classList.toggle('hidden')
      }
      if (themeToggleLightIcon) {
        themeToggleLightIcon.classList.toggle('hidden')
      }

      // if set via local storage previously
      if (localStorage.getItem('color-theme')) {
        if (localStorage.getItem('color-theme') === 'light') {
          document.documentElement.classList.add('dark')
          localStorage.setItem('color-theme', 'dark')
        } else {
          document.documentElement.classList.remove('dark')
          localStorage.setItem('color-theme', 'light')
        }

        // if NOT set via local storage previously
      } else {
        if (document.documentElement.classList.contains('dark')) {
          document.documentElement.classList.remove('dark')
          localStorage.setItem('color-theme', 'light')
        } else {
          document.documentElement.classList.add('dark')
          localStorage.setItem('color-theme', 'dark')
        }
      }
    })
  }
</script>
